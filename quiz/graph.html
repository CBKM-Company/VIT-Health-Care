<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Visitors</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<script>
    function exit(){
        alert('exit');
        localStorage.clear();
        window.location.href = 'login.html';
    }
</script>

<body>
    <center>
        <button type="button" class="btn btn-outline-danger mt-0" onclick="exit()">Exit</button>
    </center>
    <canvas id="myChart" width="100%" height="100%"></canvas>
    <script>
            const getStorage = (item) => (JSON.parse(localStorage.getItem(item)))
            const setStorage = (item, data) => (localStorage.setItem(item, JSON.stringify(data)))
            const removeStorage = (item) => (localStorage.removeItem(item))
        axios.post('http://vit-health-care.herokuapp.com/patient/getphone',{phone:getStorage('contact')})
            .then(res => {
                lables = []
                dataset1=[]
               
                dataset2=[]
               
                dataset3=[]

                console.log(res.data.data[0].records)
                res.data.data[0].records.map(d=>{
                    dataset1.push(d.marks.depression)
                    lables.push(d.createdAt.split('T')[0])
                    dataset2.push(d.marks.dementia)
                   
                    dataset3.push(d.marks.delirium)
                    

                })
                

                
                // res.data.records.pm
                // res.data.data.map(d => {
                //     data.push(`${d.stamp.split(':')[0]}`)
                // })
                // // console.log(data)
                // lables = data.filter((v, i, a) => a.indexOf(v) === i);
                // console.log(lables)
               
                // for (i = 0; i < lables.length; i++) {
                //     for(j=0;j<data.length;j++){
                //         if(data[j]==lables[i]){
                //             dataset[i]=dataset[i]?dataset[i]+1:1
                //         }
                //     }
                // }
                // console.log(dataset)

                var ctx = document.getElementById('myChart');
                var myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: lables,
                        datasets: [
                        {
                            label: 'Depression',
                            data: dataset1,
                            borderColor:'red',
                            backgroundColor:'rgba(255,0,0,0.3)'

                        },
                        {
                            label: 'Dementia',
                            data: dataset2,
                            borderColor:'green',
                            backgroundColor:'rgba(0,255,0,0.3)'


                        },
                        {
                            label: 'Delirium',
                            data: dataset3,
                            borderColor:'blue',
                            backgroundColor:'rgba(0,0,255,0.3)'


                        },

                        ]
                    },


                });
            })

    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>

</html>