<!doctype html>
<html lang="en">
  <head>
      <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
        body{
            background-color: blueviolet
        }
            .lds-ripple {
                display: inline-block;
                position: relative;
                width: 64px;
                height: 64px;
              }
              .lds-ripple div {
                position: absolute;
                border: 4px solid #fff;
                opacity: 1;
                border-radius: 50%;
                animation: lds-ripple 1s cubic-bezier(0, 0.2, 0.8, 1) infinite;
              }
              .lds-ripple div:nth-child(2) {
                animation-delay: -0.5s;
              }
              @keyframes lds-ripple {
                0% {
                  top: calc(100px + 2vh);
                  left: calc(50px + 2vh);
                  width: 0;
                  height: 0;
                  opacity: 1;
                }
                100% {
                  top: -1px;
                  left: -1px;
                  width: calc(300px + 2vh);
                  height: calc(300px + 2vh);
                  opacity: 0;
                }
              }
              
          
    </style>
    
    
    <script>
      var modelresult;
  async function getResult(){
    result = getStorage('mar');
    const model = await tf.loadLayersModel('http://vit-health-care.herokuapp.com/static/model.json');
     modelresult = model.predict(tf.tensor2d([[result.depression,result.dementia,result.delirium]])).dataSync();

     axios.post('http://vit-health-care.herokuapp.com/patient/addrecord',{
      id:getStorage('id'),
      ID:"ScreenTest-01-dementia-depression-delirium",
      marks:{
        depression:result.depression,
        dementia:result.dementia,
        delirium:result.delirium,
        result:modelresult
      }
    })
    .then(res=>{
      if(res.data.success){
        
        console.log(res.data);
       alert('done')
       
      }
    })

    
  }
  </script>
    <script>
        function checkRecord(){
            window.location.href = 'records.html'
        }
    </script>
    <title>Result</title>
    <script>
            const getStorage = (item) => (JSON.parse(localStorage.getItem(item)))
            const setStorage = (item, data) => (localStorage.setItem(item, JSON.stringify(data)))
            const removeStorage = (item) => (localStorage.removeItem(item))
        result = getStorage('result');
        setTimeout(()=>{
            document.getElementById('showResult').innerHTML = `<h2>Depression: ${result.depression}<br>
            Dementia: ${result.dementia}</h2><br>
            <button onclick="checkRecord()">Check Records</button>` 
        },2000)
    </script>
  </head>
  <body >
      <center>
          <div id="showResult">
    <div class="lds-ripple"><div></div><div></div></div>
</div>
</center>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </body>
</html>